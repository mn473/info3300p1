<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <title>Perfume Sampling</title>
</head>
<body>
    <script>
        function samplePerfumesFromCSV(data) {
            data = String(data);
            console.log(data);
            const lines = data.split('\n');
            const headers = lines[0].split(',');

            console.log(lines);

            let perfumes = [];
            for (let i = 1; i < lines.length; i++) {
                const row = lines[i].split(',');
                const obj = {};
                headers.forEach((header, index) => {
                    obj[header.trim()] = row[index] ? row[index].trim() : "";
                });
                // Filter by rows where `scents_group` and `middle_note` are not empty
                if (obj['scents_group'] && obj['middle_note']) {
                    perfumes.push({
                        'scents_group': obj['scents_group'],
                        'middle_note': obj['middle_note']
                    });
                }
            }
            console.log(perfumes);

            // Random sampling logic: Shuffle and slice the array
            const shuffledPerfumes = perfumes.sort(() => 0.5 - Math.random());

            // sample 100 perfumes
            const sampleSize = 100;
            const sampledPerfumes = shuffledPerfumes.slice(0, sampleSize);

            console.log('Sampled Perfumes:', sampledPerfumes);

            return sampledPerfumes;
        }

        // Call the function with the CSV content
        data = d3.csv('filtered_top_8_scents.csv');
        console.log(data);
        samplePerfumesFromCSV(data);
    </script>
</body>
</html>
